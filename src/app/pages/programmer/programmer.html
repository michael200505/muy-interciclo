<app-header></app-header>

<page-container class="page page--programmer anim-in">
  <h1>Panel del Programador</h1>

  <!-- PROYECTOS -->
  <section class="card">
    <div class="title-row">
      <div>
        <h2>Mis Proyectos</h2>
        <p class="sub">Gestiona tus proyectos publicados.</p>
      </div>

      <a class="btn-new" routerLink="/programmer/new-project">+ Nuevo Proyecto</a>
    </div>

    <div *ngIf="loadingProjects" class="hint">Cargando proyectos...</div>
    <div *ngIf="!loadingProjects && projects.length === 0" class="hint">No tienes proyectos aún.</div>

    <div class="project-grid" *ngIf="!loadingProjects && projects.length > 0">
      <article class="project" *ngFor="let p of projects">
        <div class="project-head">
          <h3 title="{{ p.title }}">{{ p.title }}</h3>
          <span class="pill">{{ p.type }}</span>
        </div>

        <p class="desc">{{ p.description }}</p>

        <div class="meta">
          <span><b>Rol:</b> {{ p.role }}</span>
          <span><b>Tecnologías:</b> {{ p.technologies.join(', ') }}</span>
        </div>

        <div class="links" *ngIf="p.repoURL || p.demoURL">
          <a *ngIf="p.repoURL" [href]="p.repoURL" target="_blank" rel="noopener">Repositorio</a>
          <a *ngIf="p.demoURL" [href]="p.demoURL" target="_blank" rel="noopener">Demo</a>
        </div>

        <div class="actions">
          <a class="edit" [routerLink]="['/programmer/edit', p.id]">Editar</a>
          <button class="delete" (click)="deleteProject(p)">Eliminar</button>
        </div>
      </article>
    </div>
  </section>

  <!-- ASESORÍAS -->
  <section class="card">
    <div class="title-row">
      <div>
        <h2>Solicitudes de Asesorías</h2>
        <p class="sub">Aprueba o rechaza solicitudes pendientes.</p>
      </div>
    </div>

    <div *ngIf="asesorias.length === 0" class="hint">No tienes solicitudes aún.</div>

    <div class="asesoria-list" *ngIf="asesorias.length > 0">
      <article class="asesoria" *ngFor="let a of asesorias">
        <div class="a-head">
          <div class="a-left">
            <div class="a-name">{{ a.name }}</div>
            <div class="a-meta">{{ a.date }} — {{ a.hour }}</div>
          </div>

          <span class="pill pill--status" [class.p-ok]="a.status==='approved'" [class.p-bad]="a.status==='rejected'">
            {{ a.status }}
          </span>
        </div>

        <div class="a-body">
          <div class="a-row">
            <b>Motivo:</b>
            <span>{{ a.comment || '—' }}</span>
          </div>

          <div class="a-row" *ngIf="a.response">
            <b>Respuesta:</b>
            <span>{{ a.response }}</span>
          </div>
        </div>

        <div class="a-actions" *ngIf="a.status === 'pending'">
          <button (click)="approve(a)" class="approve">Aprobar</button>
          <button (click)="reject(a)" class="reject">Rechazar</button>
        </div>
      </article>
    </div>
  </section>
</page-container>
